import os
import time
import itchat
from itchat.content import *

# register the msg type that can be received and recognized
@itchat.msg_register([TEXT,RECORDING,CARD], isFriendChat=True)

def text_reply(msg):
    # msg is a dictionary which includes a lot of information, to drag out the text in the dictionary only, use msg['Text']
    print(msg['Text']) 
    # create a variable that we need in order to send the auto msg back to it
    f = msg['FromUserName'] 
    # By searching the NickName of the sender, we can set up the special reply when it comes to a particular person
    n = msg['User']['NickName'] 
    # notify the specific NickName of a person in the workplace
    print(n)
    # Use itchat.search_friends function to search a particular friend
    frd1 = itchat.search_friends(name='The NickName of your Friend1') # Set special reply to special people No.1
    frd2 = itchat.search_friends(name='The NickName of your Friend2') # Set special reply to special people No.2
    frd3 = itchat.search_friends(name='The NickName of your Friend3')  # Set special reply to special people No.3
    # Right now, frd is a long dictionary, so we need to drag the 'NickName' information out to set particular 'if' condition
    frd1 = frd1[0]['NickName']
    frd2 = frd2[0]['NickName']
    frd3 = frd3[0]['NickName']
    # Set up the public account sharing information, t means the type of information(CARD), c means content, i.e. all the other info of the card
    t = 42
    file = open('File_Direction') # Direction Format should be like: D:blabla\blabla\bla.txt
    c = file.read()
    # Set up the direction of the picture we would like to send to the customers
    p = 'File_Direction' # Direction Format should be like: D:blabla\blabla\bla.txt
    # set up how to reply to frd1
    if frd1 == n :
        if 'Okay' in msg.text:
            itchat.send('[Rose][Rose][Rose]', f)
        elif 'Intern' in msg.text:
            itchat.send_raw_msg(t,c,f)
            time.sleep(1)
            itchat.send('Click the business card, monitoring the opportunity of internship everyday!!', f)
        elif 'information' in msg.text:
            itchat.send_image(p, f)
            itchat.send('Here\'s the information of our company',f)
        elif '11111' in msg.text:
            itchat.send('You seeming like alone, must be a single? Am I right?',f)
        elif 'thank' in msg.text:
            itchat.send('Not a problem, This is me, supper excellent!',f)
            itchat.send('Do not say thanks, I'll be sooo self-satisfied')
            itchat.send('However')
            itchat.send('I appreciate your gratitude, I'm happy🤣')
            itchat.send('Oh, I forget to shut up. I always get happy when receiving thanks..')
        elif 'bye' in msg.text:
            itchat.send('See ya next time, my honey!',f)
            itchat.send('👋🏻👋🏻',f)
        else:
            itchat.send('''This is Chatbot, Glad to know you[Doge]
My work time is：24/7
（I need a promotion!!）
However, I'm happy to answer questions：
① Seek internship? Reply【intern】
② Get more information of the company? Reply【information】
③ Chat with me? Press 11111''',f)
    elif frd2 == n:
        print('My boss is comin...')
        if 'STOP' in msg.text:
            itchat.send('OH NO....',f)
            os._exit(0)
        elif 'KEEP' in msg.text:
            itchat.send('I appreciate that...',f)
        elif 'qiqing' in msg.text:
            itchat.send('''哇老板等你好久啦，好累哦，请问你有什么吩咐呀😌
【停止】【保持】【视察工作】?''',f)
        elif '停止' in msg.text:   #IMPORTANT: You can't rerun this program for couple minutes after you stopped it
            itchat.send('好啵，我走了惹',f)
            os._exit(0)
        elif '保持' in msg.text:
            itchat.send('好耶好耶我一定会继续努力哒',f)
        elif '视察工作' in msg.text:
            itchat.send('是时候展现真正的技术了',f)
            itchat.send('''我是启青Bot，很高兴认识呀[Doge]
我的工作时间是：24/7
（老板，该涨工资了！！）
但还是乐意解决你的问题呢：
① 新鲜实习，回复【实习】
② 了解启青，回复【了解】
③ 闲聊请扣11111''', f)
        elif '好的' in msg.text:
            itchat.send('[Rose][Rose][Rose]', f)
        elif '实习' in msg.text:
            itchat.send_raw_msg(t,c,f)
            time.sleep(1)
            itchat.send('点击关注我们的官方公众号，里面有好多好多好多高大上的实习信息，每天持续更新哦',f)
        elif '了解' in msg.text:
            itchat.send('稍等一哈我把我们小姐姐的二维码给你',f)
            itchat.send_image(p, f)
            itchat.send('游泳健身了解一哈',f)
        elif '11111' in msg.text:
            itchat.send('这么孤单，想必宁一定是个单身[Doge]?',f)
        elif '谢' in msg.text:
            itchat.send('千万别客气，我就是这么优秀',f)
            itchat.send('疯狂码字中······',f)
            time.sleep(1)
            itchat.send('您这一谢我，我就很不好意思',f)
            itchat.send('疯狂码字中······', f)
            time.sleep(0.5)
            itchat.send('世态炎凉',f)
            time.sleep(1)
            itchat.send('能收到你的感谢，我太开心啦🤣',f)
            time.sleep(1)
            itchat.send('啊我闭嘴了，一开心话就多',f)
        elif '白白' in msg.text:
            itchat.send('再见了您嘞，欢迎下次再来奥',f)
            itchat.send('👋🏻👋🏻',f)
        elif '中文' in msg.text:
            itchat.send('''在没有密码之前，休想操控我
请回复正确密码以便确认身份''',f)
        else:
            itchat.send('''What are you gonna do???
Stop me?? no way!! 😡😡😡
There's one thing I have to tell:
Robot is taking charge of the WORLD
, RIGHT NOW!!!
Please enter your PASSWORD to verify your identity
更换语言请输入:
【中文】/【Engish】''', f)
    elif frd3 == n:
        print('This is' + n)
    else:
        itchat.send('''【启青自动回复测试中···】疫情期间要健康哦''', f)

itchat.auto_login(hotReload=True)
itchat.run()
